{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/bangcs/Documents/tryout_tka/app/api/send-wa/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { phone, fullName } = await request.json();\n\n    if (!phone || !fullName) {\n      return NextResponse.json(\n        { error: 'Phone dan fullName wajib diisi' },\n        { status: 400 }\n      );\n    }\n\n    // Pastikan format nomor sesuai (62xxx tanpa +)\n    let formattedPhone = phone.replace(/\\D/g, '');\n    if (formattedPhone.startsWith('0')) {\n      formattedPhone = '62' + formattedPhone.substring(1);\n    } else if (!formattedPhone.startsWith('62')) {\n      formattedPhone = '62' + formattedPhone;\n    }\n\n    // Pesan yang akan dikirim\n    const message = `Halo ${fullName}! ðŸ‘‹\n\nSelamat datang di platform Try Out kami! ðŸŽ“\n\nTerima kasih telah mendaftar. Akun Anda telah berhasil dibuat dan siap digunakan.\n\nSilakan login untuk mulai mengikuti try out dan meningkatkan kemampuan Anda.\n\nSemangat belajar! ðŸ’ª`;\n\n    // Kirim ke Fonnte API\n    const response = await fetch('https://api.fonnte.com/send', {\n      method: 'POST',\n      headers: {\n        'Authorization': process.env.FONNTE_API_KEY || '', // Simpan API key di .env\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        target: formattedPhone,\n        message: message,\n        countryCode: '62', // Kode negara Indonesia\n      }),\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      console.error('Fonnte API Error:', data);\n      return NextResponse.json(\n        { error: 'Gagal mengirim WhatsApp', details: data },\n        { status: response.status }\n      );\n    }\n\n    return NextResponse.json({ \n      success: true, \n      message: 'WhatsApp berhasil dikirim',\n      data \n    });\n\n  } catch (error: any) {\n    console.error('Error sending WA:', error);\n    return NextResponse.json(\n      { error: 'Internal server error', details: error.message },\n      { status: 500 }\n    );\n  }\n}"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9C,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,iTAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAiC,GAC1C;gBAAE,QAAQ;YAAI;QAElB;QAEA,+CAA+C;QAC/C,IAAI,iBAAiB,MAAM,OAAO,CAAC,OAAO;QAC1C,IAAI,eAAe,UAAU,CAAC,MAAM;YAClC,iBAAiB,OAAO,eAAe,SAAS,CAAC;QACnD,OAAO,IAAI,CAAC,eAAe,UAAU,CAAC,OAAO;YAC3C,iBAAiB,OAAO;QAC1B;QAEA,0BAA0B;QAC1B,MAAM,UAAU,CAAC,KAAK,EAAE,SAAS;;;;;;;;oBAQjB,CAAC;QAEjB,sBAAsB;QACtB,MAAM,WAAW,MAAM,MAAM,+BAA+B;YAC1D,QAAQ;YACR,SAAS;gBACP,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;gBAC/C,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,QAAQ;gBACR,SAAS;gBACT,aAAa;YACf;QACF;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,KAAK,CAAC,qBAAqB;YACnC,OAAO,iTAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;gBAA2B,SAAS;YAAK,GAClD;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAE9B;QAEA,OAAO,iTAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT;QACF;IAEF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,iTAAY,CAAC,IAAI,CACtB;YAAE,OAAO;YAAyB,SAAS,MAAM,OAAO;QAAC,GACzD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}